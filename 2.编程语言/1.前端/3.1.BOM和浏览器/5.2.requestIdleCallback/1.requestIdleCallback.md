# requestIdleCallback

## 概述

+ window.requestIdleCallback() 方法插入一个函数，这个函数将在浏览器空闲时期被调用
+ 这使开发者能够在主事件循环上执行后台和低优先级工作，而不会影响延迟关键事件，如动画和输入响应
+ 函数一般会按先进先调用的顺序执行，然而，如果回调函数指定了执行超时时间timeout，则有可能为了在超时前执行函数而打乱执行顺序

+ *不重要且不紧急的任务*

## 语法

+ 语法1 `requestIdleCallback(callback)`
+ 语法2 `requestIdleCallback(callback, options)`

  + callback：一个在事件循环空闲时即将被调用的函数的引用
  + options

    + timeout：如果指定了 timeout，并且有一个正值，而回调在 timeout 毫秒过后还没有被调用，那么回调任务将放入事件循环中排队，即使这样做有可能对性能产生负面影响

+ 返回值：一个 ID，可以把它传入 Window.cancelIdleCallback() 方法来结束回调

## 使用场景

+ 不要执行DOM修改操作
+ Promise的resolve(reject)操作也不建议放在里面，因为Promise的回调会在idle的回调执行完成后立刻执行，会拉长当前帧的耗时，所以不推荐

+ 推荐放在requestIdleCallback里面的应该是小块的（microTask）并且可预测时间的任务
