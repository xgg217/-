# watch

## 概述

+ 等效于 vue2 的 `$watch`

+ 默认是懒侦听的，即仅在侦听源发生变化时才执行回调函数

+ 除非配置了 `options`

## 语法

+ *第一个参数*是侦听器的**源**。这个来源可以是以下几种

  + 一个函数，返回一个值

  + 一个 ref

  + 一个响应式对象

  + ...或是由以上类型的值组成的数组

+ *第二个参数*是在发生变化时要调用的回调函数。这个回调函数接受三个参数：新值、旧值，以及一个用于注册副作用清理的回调函数。该回调函数会在副作用下一次重新执行前调用，可以用来清除无效的副作用，例如等待中的异步请求

  + 当侦听多个来源时，回调函数接受两个数组，分别对应来源数组中的新值和旧值

+ 第三个可选的参数是一个对象，支持以下这些选项：

  + `immediate：true/false`

    + 默认情况下，watch 对应的回调函数是懒执行的，只有在依赖的数据发生变化时，才会执行回调
    + 但是在某些场景中，我们可能期望立即执行一次，例如请求一些初始化数据，这个时候就可以设置该配置项。第一次调用时旧值是 `undefined`

  + `once：true/false` 侦听器的回调函数只执行一次

  + `deep：true/false`

    + 强制转换为深层次侦听器
    + 什么时候会用到呢？有些时候使用 watch 来侦听一个由计算属性或者 getter 函数返回的对象的时候，默认就不是深层次的侦听
    + 通过设置 deep 可以让这种情况下的对象侦听，也变成深层次的侦听
