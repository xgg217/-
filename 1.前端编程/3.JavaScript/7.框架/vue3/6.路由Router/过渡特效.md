# 过渡特效

## 概述

+ 为路由切换添加过渡效果，其实就是使用 `Transition` 内置组件

  ```html
  <router-view v-slot="{ Component }">
    <Transition name="fade" mode="out-in">
      <component :is="Component" />
    </Transition>
  </router-view>

  <style scoped>
  .fade-enter-active,
  .fade-leave-active {
    transition: opacity 0.4s;
  }

  .fade-enter-from,
  .fade-leave-to {
    opacity: 0;
  }
  </style>
  ```

## 单个路由的过渡

+ 如果对不同的路由的过渡有需求，那么可以通过以下的设置来做

+ `meta` ：设置元数据，上面记录过渡的方式
+ `RouterView` 插槽，通过插槽拿到 `route` ，从而拿到元数据里面的过渡方式
+ `<Transition>` 组件设置不同的 name 值从而应用不同的过渡方式

  ```js
  // 路径配置文件
  router.afterEach((to) => {
    switch (to.path) {
      case '/panel-left':
        to.meta.transition = 'slide-left'
        break
      case '/panel-right':
        to.meta.transition = 'slide-right'
        break
      default:
        to.meta.transition = 'fade'
    }
  })
  ```

  ```html
  <!-- App.vue -->
  <template>
    <div id="app">
      <nav>
        <router-link to="/">首页</router-link>
        <router-link to="/about">关于</router-link>
        <router-link to="/contact">联系</router-link>
        <router-link to="/panel-left">Panel Left</router-link>
        <router-link to="/panel-right">Panel Right</router-link>
      </nav>
      <router-view v-slot="{ Component, route }">
        <Transition :name="route.meta.transition || 'fade'" mode="out-in">
          <component :is="Component" />
        </Transition>
      </router-view>
    </div>
  </template>

  <style scoped>
  .fade-enter-active,
  .fade-leave-active {
    transition: opacity 0.4s;
  }
  .fade-enter-from,
  .fade-leave-to {
    opacity: 0;
  }
  /* 添加不同的过渡样式 */
  .slide-left-enter-active,
  .slide-left-leave-active {
    transition: transform 0.5s;
  }

  .slide-left-enter-from,
  .slide-left-leave-to {
    transform: translateX(-100%);
  }

  .slide-right-enter-active,
  .slide-right-leave-active {
    transition: transform 0.5s;
  }

  .slide-right-enter-from,
  .slide-right-leave-to {
    transform: translateX(100%);
  }
  </style>
  ```

## 基于路由动态过渡

+ 可以使用导航守卫（全局后置守卫）来添加过渡效果

  ```js
  router.afterEach((to) => {
    switch (to.path) {
      case '/panel-left':
        to.meta.transition = 'slide-left'
        break
      case '/panel-right':
        to.meta.transition = 'slide-right'
        break
      default:
        to.meta.transition = 'fade'
    }
  })
  ```

## 使用Key

+ Vue 可能会自动复用看起来相似的组件，从而忽略了任何过渡，可以添加一个 `key` 属性来强制过渡

  ```js
  // 路由配置页面
  import { createRouter, createWebHistory } from 'vue-router'

  const routes = [
    { path: '/', name: 'ItemList', component: () => import('../views/ItemList.vue') },
    { path: '/item/:id', name: 'ItemDetail', component: () => import('../views/ItemDetail.vue') }
  ]

  const router = createRouter({
    history: createWebHistory(),
    routes
  })

  export default router
  ```

  ```html
  <!-- App.vue -->
  <template>
    <div id="app">
      <router-view v-slot="{ Component, route }">
        <transition name="fade" mode="out-in">
          <component :is="Component" :key="route.path" />
        </transition>
      </router-view>
    </div>
  </template>

  <script setup></script>

  <style scoped>
  #app {
    font-family: Arial, sans-serif;
    background-color: #f8f9fa;
    margin: 0;
    padding: 0;
    text-align: center;
  }

  nav {
    display: flex;
    justify-content: center;
    background-color: #343a40;
    padding: 10px;
    margin-bottom: 20px;
  }

  nav a {
    margin: 0 15px;
    color: #fff;
    text-decoration: none;
  }

  nav a:hover {
    text-decoration: underline;
  }

  .router-link-exact-active {
    font-weight: bold;
    text-decoration: underline;
  }

  .fade-enter-active,
  .fade-leave-active {
    transition: opacity 0.5s;
  }

  .fade-enter-from,
  .fade-leave-to {
    opacity: 0;
  }
  </style>

  ```
